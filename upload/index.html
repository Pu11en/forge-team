<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ForgeBot Image Upload</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: #0a0a0a;
            color: #fff;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }
        h1 { margin-bottom: 8px; }
        .subtitle { color: #888; margin-bottom: 24px; font-size: 14px; }
        .dropzone {
            width: 100%;
            max-width: 500px;
            border: 2px dashed #333;
            border-radius: 16px;
            padding: 48px 24px;
            text-align: center;
            cursor: pointer;
            transition: all 0.2s;
        }
        .dropzone:hover, .dropzone.dragover {
            border-color: #EA580C;
            background: rgba(234,88,12,0.1);
        }
        .dropzone-icon { font-size: 48px; margin-bottom: 12px; }
        .dropzone-text { color: #888; }
        input[type="file"] { display: none; }
        .results {
            margin-top: 24px;
            width: 100%;
            max-width: 500px;
        }
        .result-item {
            background: #111;
            border: 1px solid #222;
            border-radius: 12px;
            padding: 16px;
            margin-bottom: 12px;
        }
        .result-preview {
            width: 100%;
            max-height: 200px;
            object-fit: contain;
            border-radius: 8px;
            margin-bottom: 12px;
        }
        .result-url {
            background: #000;
            border: 1px solid #333;
            border-radius: 8px;
            padding: 12px;
            font-family: monospace;
            font-size: 12px;
            word-break: break-all;
            color: #22c55e;
        }
        .copy-btn {
            margin-top: 8px;
            background: #EA580C;
            color: #fff;
            border: none;
            padding: 8px 16px;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            width: 100%;
        }
        .copy-btn:hover { background: #f97316; }
        .copy-btn.copied { background: #22c55e; }
        .loading {
            display: none;
            color: #888;
            margin-top: 16px;
        }
        .loading.active { display: block; }
        .error { color: #ef4444; margin-top: 16px; }
        .instructions {
            margin-top: 32px;
            padding: 16px;
            background: #111;
            border-radius: 12px;
            max-width: 500px;
            font-size: 13px;
            color: #888;
        }
        .instructions strong { color: #fff; }
    </style>
</head>
<body>
    <h1>üì§ ForgeBot Upload</h1>
    <p class="subtitle">Upload images to share with ForgeBot</p>
    
    <div class="dropzone" id="dropzone">
        <div class="dropzone-icon">üñºÔ∏è</div>
        <div class="dropzone-text">Drop images here or click to browse</div>
        <input type="file" id="fileInput" accept="image/*,video/*" multiple>
    </div>
    
    <div class="loading" id="loading">‚è≥ Uploading...</div>
    <div class="error" id="error"></div>
    
    <div class="results" id="results"></div>
    
    <div class="instructions">
        <strong>How to use:</strong><br>
        1. Drop or select images above<br>
        2. Copy the URL<br>
        3. Paste URL to ForgeBot in Slack<br><br>
        <strong>Tip:</strong> ForgeBot can analyze the image from the URL!
    </div>

    <script>
        const CLOUD_NAME = 'djg0pqts6';
        const UPLOAD_PRESET = 'forgebot_unsigned';
        
        const dropzone = document.getElementById('dropzone');
        const fileInput = document.getElementById('fileInput');
        const results = document.getElementById('results');
        const loading = document.getElementById('loading');
        const errorDiv = document.getElementById('error');
        
        dropzone.addEventListener('click', () => fileInput.click());
        
        dropzone.addEventListener('dragover', (e) => {
            e.preventDefault();
            dropzone.classList.add('dragover');
        });
        
        dropzone.addEventListener('dragleave', () => {
            dropzone.classList.remove('dragover');
        });
        
        dropzone.addEventListener('drop', (e) => {
            e.preventDefault();
            dropzone.classList.remove('dragover');
            handleFiles(e.dataTransfer.files);
        });
        
        fileInput.addEventListener('change', (e) => {
            handleFiles(e.target.files);
        });
        
        async function handleFiles(files) {
            errorDiv.textContent = '';
            loading.classList.add('active');
            
            for (const file of files) {
                try {
                    const url = await uploadToCloudinary(file);
                    addResult(file, url);
                } catch (err) {
                    errorDiv.textContent = `Error uploading ${file.name}: ${err.message}`;
                }
            }
            
            loading.classList.remove('active');
        }
        
        async function uploadToCloudinary(file) {
            const formData = new FormData();
            formData.append('file', file);
            formData.append('upload_preset', UPLOAD_PRESET);
            
            const res = await fetch(`https://api.cloudinary.com/v1_1/${CLOUD_NAME}/auto/upload`, {
                method: 'POST',
                body: formData
            });
            
            if (!res.ok) {
                const err = await res.json();
                throw new Error(err.error?.message || 'Upload failed');
            }
            
            const data = await res.json();
            return data.secure_url;
        }
        
        function addResult(file, url) {
            const div = document.createElement('div');
            div.className = 'result-item';
            div.innerHTML = `
                <img src="${url}" alt="${file.name}" class="result-preview">
                <div class="result-url">${url}</div>
                <button class="copy-btn" onclick="copyUrl(this, '${url}')">üìã Copy URL</button>
            `;
            results.prepend(div);
        }
        
        function copyUrl(btn, url) {
            navigator.clipboard.writeText(url);
            btn.textContent = '‚úÖ Copied!';
            btn.classList.add('copied');
            setTimeout(() => {
                btn.textContent = 'üìã Copy URL';
                btn.classList.remove('copied');
            }, 2000);
        }
    </script>
</body>
</html>
